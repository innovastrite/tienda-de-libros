{% extends 'catalogo/base.html' %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3>Registrar Venta - {{ libro.titulo }}</h3>
                </div>
                <div class="card-body">
                    <div class="mb-4">
                        <h5>Detalles del libro:</h5>
                        <p><strong>Autor:</strong> {{ libro.autor }}</p>
                        <p><strong>Categor√≠a:</strong> {{ libro.categoria.nombre }}</p>
                        <p><strong>Precio:</strong> ${{ libro.precio }}</p>
                    </div>

                    <form method="POST">
                        {% csrf_token %}
                        <div class="form-group mb-3">
                            <label for="cantidad">Cantidad:</label>
                            <input type="number" 
                                   class="form-control" 
                                   id="cantidad" 
                                   name="cantidad" 
                                   value="1" 
                                   min="1" 
                                   required>
                        </div>

                        <div class="mb-3">
                            <p><strong>Total a pagar:</strong> 
                                <span id="total">${{ libro.precio }}</span>
                            </p>
                        </div>

                        <button type="submit" class="btn btn-primary">Confirmar Compra</button>
                        <a href="{% url 'detalle_libro' libro.id %}" class="btn btn-secondary">Cancelar</a>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('cantidad').addEventListener('change', function(e) {
    const cantidad = parseInt(e.target.value) || 0;
    const precio = {{ libro.precio }};
    const total = (cantidad * precio).toFixed(2);
    document.getElementById('total').textContent = '$' + total;
});
</script>
{% endblock %}